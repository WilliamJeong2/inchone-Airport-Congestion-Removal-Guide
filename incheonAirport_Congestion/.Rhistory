w201704 <- read_excel("R_Data/airport 2017/w201704.xls")
w201705 <- read_excel("R_Data/airport 2017/w201705.xls")
w201706 <- read_excel("R_Data/airport 2017/w201706.xls")
w201707 <- read_excel("R_Data/airport 2017/w201707.xls")
w201708 <- read_excel("R_Data/airport 2017/w201708.xls")
w201709 <- read_excel("R_Data/airport 2017/w201709.xls")
w201710 <- read_excel("R_Data/airport 2017/w201710.xls")
w201711 <- read_excel("R_Data/airport 2017/w201711.xls")
w201712 <- read_excel("R_Data/airport 2017/w201712.xls")
library(ggplot2)
ggplot(w201701, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 1월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201702, aes(x=요일, y=합계,group=1))+ggtitle("2017년 2월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201703, aes(x=요일, y=합계,group=1))+ggtitle("2017년 3월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201704, aes(x=요일, y=합계,group=1))+ggtitle("2017년 4월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201705, aes(x=요일, y=합계,group=1))+ggtitle("2017년 5월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201706, aes(x=요일, y=합계,group=1))+ggtitle("2017년 6월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201707, aes(x=요일, y=합계,group=1))+ggtitle("2017년 7월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201708, aes(x=요일, y=합계,group=1))+ggtitle("2017년 8월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201709, aes(x=요일, y=합계,group=1))+ggtitle("2017년 9월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201710, aes(x=요일, y=합계,group=1))+ggtitle("2017년 10월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201711, aes(x=요일, y=합계,group=1))+ggtitle("2017년 11월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
ggplot(w201712, aes(x=요일, y=합계,group=1))+ggtitle("2017년 12월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
install.packages("readxl")
install.packages("ggplot2")
library(readxl)
w201401 <- read_excel("R_Data/airport 2014/w201401.xls")
w201402 <- read_excel("R_Data/airport 2014/w201402.xls")
w201403 <- read_excel("R_Data/airport 2014/w201403.xls")
w201404 <- read_excel("R_Data/airport 2014/w201404.xls")
w201405 <- read_excel("R_Data/airport 2014/w201405.xls")
w201406 <- read_excel("R_Data/airport 2014/w201406.xls")
w201407 <- read_excel("R_Data/airport 2014/w201407.xls")
w201408 <- read_excel("R_Data/airport 2014/w201408.xls")
w201409 <- read_excel("R_Data/airport 2014/w201409.xls")
w201410 <- read_excel("R_Data/airport 2014/w201410.xls")
w201411 <- read_excel("R_Data/airport 2014/w201411.xls")
w201412 <- read_excel("R_Data/airport 2014/w201412.xls")
library(ggplot2)
ggplot(w201401, aes(x=?슂?씪, y=?빀怨?,group=1))+ggtitle("2014?뀈 1?썡")+geom_line()+geom_line(aes(x=?슂?씪, y=異쒕컻), colour="red") +geom_line(aes(x=?슂?씪,y=?룄李?),colour="blue")+geom_point()+geom_point(aes(x=?슂?씪,y=異쒕컻),colour="red")+geom_point(aes(x=?슂?씪,y=?룄李?),colour="blue")
=======
}
else if(x==02){
ggplot(w201702, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 2월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==03){
ggplot(w201703, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 3월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==04){
ggplot(w201704, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 4월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==05){
ggplot(w201705, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 5월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==06){
ggplot(w201706, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 6월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==07){
ggplot(w201707, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 7월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==08){
ggplot(w201708, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 8월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==09){
ggplot(w201709, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 9월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==10){
ggplot(w2017010, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 10월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==11){
ggplot(w2017011, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 11월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==12){
ggplot(w2017012, aes(x=요일, y=합계,group=1)) +ggtitle("2017년 12월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else{
cat("다시 입력 하세요.")
}
}
w_2017sub2 <- function(x){
if(x==01){
aggregate(요일~합계, w201701, max)
}
else if(x==02){
aggregate(요일~합계, w201702, max)
}
else if(x==03){
aggregate(요일~합계, w201703, max)
}
else if(x==04){
aggregate(요일~합계, w201704, max)
}
else if(x==05){
aggregate(요일~합계, w201705, max)
}
else if(x==06){
aggregate(요일~합계, w201706, max)
}
else if(x==07){
aggregate(요일~합계, w201707, max)
}
else if(x==08){
aggregate(요일~합계, w201708, max)
}
else if(x==09){
aggregate(요일~합계, w201709, max)
}
else if(x==10){
aggregate(요일~합계, w2017010, max)
}
else if(x==11){
aggregate(요일~합계, w2017011, max)
}
else if(x==12){
aggregate(요일~합계, w2017012, max)
}
else{
cat("다시 입력 하세요.")
}
}
w_2016sub <- function(x){
if(x==01){
ggplot(w201601, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 1월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==02){
ggplot(w201602, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 2월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==03){
ggplot(w201603, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 3월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==04){
ggplot(w201604, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 4월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==05){
ggplot(w201605, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 5월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==06){
ggplot(w201606, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 6월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==07){
ggplot(w201607, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 7월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==08){
ggplot(w201608, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 8월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==09){
ggplot(w201609, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 9월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==10){
ggplot(w2016010, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 10월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==11){
ggplot(w2016011, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 11월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==12){
ggplot(w2016012, aes(x=요일, y=합계,group=1)) +ggtitle("2016년 12월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else{
cat("다시 입력 하세요.")
}
}
w_2016sub2 <- function(x){
if(x==01){
aggregate(요일~합계, w201601, max)
}
else if(x==02){
aggregate(요일~합계, w201602, max)
}
else if(x==03){
aggregate(요일~합계, w201603, max)
}
else if(x==04){
aggregate(요일~합계, w201604, max)
}
else if(x==05){
aggregate(요일~합계, w201605, max)
}
else if(x==06){
aggregate(요일~합계, w201606, max)
}
else if(x==07){
aggregate(요일~합계, w201607, max)
}
else if(x==08){
aggregate(요일~합계, w201608, max)
}
else if(x==09){
aggregate(요일~합계, w201609, max)
}
else if(x==10){
aggregate(요일~합계, w2016010, max)
}
else if(x==11){
aggregate(요일~합계, w2016011, max)
}
else if(x==12){
aggregate(요일~합계, w2016012, max)
}
else{
cat("다시 입력 하세요.")
}
}
w_2015sub <- function(x){
if(x==01){
ggplot(w201501, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 1월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==02){
ggplot(w201502, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 2월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==03){
ggplot(w201503, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 3월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==04){
ggplot(w201504, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 4월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==05){
ggplot(w201505, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 5월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==06){
ggplot(w201506, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 6월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==07){
ggplot(w201507, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 7월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==08){
ggplot(w201508, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 8월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==09){
ggplot(w201509, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 9월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==10){
ggplot(w2015010, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 10월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==11){
ggplot(w2015011, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 11월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==12){
ggplot(w2015012, aes(x=요일, y=합계,group=1)) +ggtitle("2015년 12월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else{
cat("다시 입력 하세요.")
}
}
w_2015sub2 <- function(x){
if(x==01){
aggregate(요일~합계, w201501, max)
}
else if(x==02){
aggregate(요일~합계, w201502, max)
}
else if(x==03){
aggregate(요일~합계, w201503, max)
}
else if(x==04){
aggregate(요일~합계, w201504, max)
}
else if(x==05){
aggregate(요일~합계, w201505, max)
}
else if(x==06){
aggregate(요일~합계, w201506, max)
}
else if(x==07){
aggregate(요일~합계, w201507, max)
}
else if(x==08){
aggregate(요일~합계, w201508, max)
}
else if(x==09){
aggregate(요일~합계, w201509, max)
}
else if(x==10){
aggregate(요일~합계, w2015010, max)
}
else if(x==11){
aggregate(요일~합계, w2015011, max)
}
else if(x==12){
aggregate(요일~합계, w2015012, max)
}
else{
cat("다시 입력 하세요.")
}
}
w_2014sub <- function(x){
if(x==01){
ggplot(w201401, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 1월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==02){
ggplot(w201402, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 2월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==03){
ggplot(w201403, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 3월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==04){
ggplot(w201404, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 4월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==05){
ggplot(w201405, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 5월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==06){
ggplot(w201406, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 6월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==07){
ggplot(w201407, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 7월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==08){
ggplot(w201408, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 8월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==09){
ggplot(w201409, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 9월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==10){
ggplot(w2014010, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 10월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==11){
ggplot(w2014011, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 11월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else if(x==12){
ggplot(w2014012, aes(x=요일, y=합계,group=1)) +ggtitle("2014년 12월")+geom_line()+geom_line(aes(x=요일, y=출발), colour="red")+geom_line(aes(x=요일,y=도착),colour="blue")+geom_point()+geom_point(aes(x=요일,y=출발),colour="red")+geom_point(aes(x=요일,y=도착),colour="blue")
}
else{
cat("다시 입력 하세요.")
}
}
w_2014sub2 <- function(x){
if(x==01){
aggregate(요일~합계, w201401, max)
}
else if(x==02){
aggregate(요일~합계, w201402, max)
}
else if(x==03){
aggregate(요일~합계, w201403, max)
}
else if(x==04){
aggregate(요일~합계, w201404, max)
}
else if(x==05){
aggregate(요일~합계, w201405, max)
}
else if(x==06){
aggregate(요일~합계, w201406, max)
}
else if(x==07){
aggregate(요일~합계, w201407, max)
}
else if(x==08){
aggregate(요일~합계, w201408, max)
}
else if(x==09){
aggregate(요일~합계, w201409, max)
}
else if(x==10){
aggregate(요일~합계, w2014010, max)
}
else if(x==11){
aggregate(요일~합계, w2014011, max)
}
else if(x==12){
aggregate(요일~합계, w2014012, max)
}
else{
cat("다시 입력 하세요.")
}
}
w_week <- function(index,x){
if(index == 2018){
w_2018sub(x)
}
else if(index == 2017){
w_2017sub(x)
}
else if(index == 2016){
w_2016sub(x)
}
else if(index == 2015){
w_2015sub(x)
}
else if(index == 2014){
w_2014sub(x)
}
else if(index == '2018년인원'){
w_2018sub2(x)
}
else if(index == '2017년인원'){
w_2017sub2(x)
}
else if(index == '2016년인원'){
w_2016sub2(x)
}
else if(index == '2015년인원'){
w_2015sub2(x)
}
else if(index == '2014년인원'){
w_2014sub2(x)
}
else {
cat("다시 입력하세요.")
}
}
w_week(2014,03)
w_week('2015년인원',07)
>>>>>>> ca966e5c866aa496f3ae745090c2b499d4cf64cc
install.packages("xlsx")
install.packages("nnet")
library(xlsx) #rJava오류 시 32비트 java다운받기
dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
install.packages("xlsx")
install.packages("nnet")
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
library(xlsx) #rJava오류 시 32비트 java다운받기
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
library(xlsx) #rJava오류 시 32비트 java다운받기
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
library(xlsx) #rJava오류 시 32비트 java다운받기
library(nnet)
install.packages("xlsx")
install.packages("nnet")
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
library(xlsx) #rJava오류 시 32비트 java다운받기
View(w201402)
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre1.8.0_101')
library(xlsx) #rJava오류 시 32비트 java다운받기
library(nnet)
par(family="NanumGothic")
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
data
install.packages("xlsx")
install.packages("nnet")
install.packages("nnet")
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre1.8.0_101')
library(rjava)
library(nnet)
library(xlsx) #rJava오류 시 32비트 java다운받기
par(family="NanumGothic")
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
install.packages("xlsx")
install.packages("nnet")
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre1.8.0_101')
library(rjava)
install.packages("rjava")
library(rjava)
library(xlsx) #rJava오류 시 32비트 java다운받기
library(nnet)
par(family="NanumGothic")
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
data
data$degree<-gsub(",","",data$degree) #인원수의 3자리 단위로 있는 ,를 삭제
data$degree<-as.numeric(data$degree) #인원수를 numeric로
df<-data.frame(일자=data$date,인원수=data$degree)
df
plot(df,xlab="일자",ylab="인원수") #일자(date)와 인원수(degree)를 plot함수로 시각화 / 필드멍에 맞춰 변수명 수정
getDataSet<-function(item,from,to,size){ #배열을 한 칸씩 이동하며 정해진 구간을 탐색하는 알고리즘
dataframe<-NULL
to<-to-size+1
for(i in from:to) {
start<-i
end<-start+size-1
temp<-item[c(start:end)]
dataframe<-rbind(dataframe,t(temp))
}
return(dataframe)
}
INPUT_NODES<-2
HIDDEN_NODES<-INPUT_NODES*2
OUTPUT_NODES<-1
ITERATION<-500
in_learning<-getDataSet(df$인원수,1,16,INPUT_NODES)
in_learning
out_learning<-getDataSet(df$인원수,3,17,OUTPUT_NODES)
out_learning
model<-nnet(in_learning,out_learning,size=HIDDEN_NODES,linout = TRUE,rang = 0.1,skip=TRUE,maxit = ITERATION)
in_forecasting<-getDataSet(df$인원수,16,17,INPUT_NODES)
in_forecasting
predicted_values<-predict(model,in_forecasting,type="raw")
predicted_values
real<-df$인원수[1:18]
real
plot(real,xlab="4월",ylab="인원수",ylim=c(500000,3000000),type="o",axes=FALSE)
axis(1,at=1:18, lab=c("2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018"))
axis(2,ylim=c(500000,3000000))
lines(18:18,predicted_values,type="o",col="red")
grid()
View(w201706)
View(w201706)
#dyn.load('/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/jre/lib/server/libjvm.dylib') #맥에는 32bit자바가 없어서 따로 지정
Sys.setenv(JAVA_HOME='C://Program Files//Java//jre1.8.0_101')
library(rjava)
library(xlsx) #rJava오류 시 32비트 java다운받기
library(nnet)
par(family="NanumGothic")
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
data<-read.xlsx2(file.choose(),1) #데이터가 될 엑셀 선택
install.packages("xlsx")
install.packages("nnet")
library(xlsx) #rJava오류 시 32비트 java다운받기
library(xlsx) #rJava오류 시 32비트 java다운받기
install.packages("xlsx")
install.packages("nnet")
library(xlsx) #rJava오류 시 32비트 java다운받기
install.packages("xlsx")
install.packages("nnet")
install.packages("rjava")
library(rjava)
install.packages("rJava")
library(rJava)
library(xlsx) #rJava오류 시 32비트 java다운받기
library(nnet)
